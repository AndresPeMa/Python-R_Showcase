---
title: "Code Replication 2"
output:
  html_document: default
  pdf_document: default
date: "2022-10-14"
---

### Load data
```{r}
load('E:/CalPoly SLO/Fall Quarter 2022/Advanced Econometrics 1/Week 4/apple.RData')
df = data
```


### Estimate the model stated using ordinary least squares, what is your estimate of β1, the price effect
```{r}
X = cbind(rep(1,5),df$regprc,df$educ,df$ecoprc,df$hhsize,df$male)
Y = df$reglbs

b = solve(t(X)%*%X)%*% (t(X)%*% Y)

b_1 = cbind(0,1,0,0,0,0)%*% b

b_1
```
The estimate of β1 is -1.6382.


### What is the R-squared for the model
```{r}
Xt = t(X)
Yt = t(Y)
SSE = Yt %*% Y - t(b)%*% Xt %*% Y
SST = sum((Y-mean(Y))^2)

Rsquared = 1 -(SSE/SST)

Rsquared
```
The R-squared of the model is 0.0116


### What is the adjusted R-squared for the model
```{r}
AdjRsquared = 1 - ((1-Rsquared)%*%(660-1)/(660-5-1))

AdjRsquared
```
The adjusted R-squared of the model is 0.0041


### Is the coefficient estimate of β3 the correct sign?
```{r}
#Yes, the sign of Beta3 is correct (+0.947) because we expect people to switch to regular apples when the price of eco apples increases which leads to an increase in purchases
```


### Add a new variable to the model that is defined as regprc×educ. The coefficient on this variable will be β6. Re-estimate your model with this additional variable. What is your estimate of this new parameter?
```{r}
A = cbind(rep(1,5),df$regprc,df$educ,df$ecoprc,df$hhsize,df$male,(df$regprc*df$educ))
B = df$reglbs

C = solve(t(A)%*%A)%*% (t(A)%*% B)

b_6 = cbind(0,0,0,0,0,0,1)%*%C

b_6
```
The estimate of β6 is -0.2209.

### Consider the price effect now ∂reglbs/∂regprc=β1+β6educ. This says that how responsive buyers are to price depends on educ. Consider a buyer with educ=20. If regprc increases by $1, what will be the change in reglbs?
```{r}
#If educ=20, the change in reglbs if regprc increases by $1 can be shown by 
ne = -b_1 + (b_6*20)

ne
```
For someone with educ=20 a one dollar increase in price will reduce demand by -2.9076 (rounding) pounds


### Using your estimates, who would you say is more sensitive to price, more educated buyers or less educated buyer? How is this conclusion relate to the sign on β6? Explain.
```{r}
#I think the more educated buyer is more sensitive to price, we can see that Beta6 in model2 shows that, for educated buyers, as the price of ecoapples increases the less ecoapples they will buy, they will substitute them with regular apples
```
